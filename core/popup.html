<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ShieldEye V0.1</title>
  <link rel="stylesheet" href="popup.css">
</head>
<body>
  <div id="app">
    <header class="header">
      <div class="header-content">
        <div class="logo">
          <img src="icons/icon32.png" alt="ShieldEye Robot" width="32" height="32" class="logo-icon">
          <div class="logo-text">
            <span>ShieldEye V0.1</span>
            <div id="currentTabInfo" class="current-tab-info" style="display: none;">
              <img id="currentTabFavicon" class="tab-favicon" src="" alt="">
              <span id="currentTabUrl"></span>
            </div>
          </div>
        </div>
        <div class="header-controls">
          <div class="toggle-switch">
            <input type="checkbox" id="enableToggle" class="toggle-input">
            <label for="enableToggle" class="toggle-label">
              <span class="toggle-slider"></span>
            </label>
          </div>
          <button id="settingsBtn" class="settings-btn" title="Settings">
            <svg width="16" height="16" viewBox="0 0 24 24">
              <path d="M19.14,12.94c0.04-0.3,0.06-0.61,0.06-0.94c0-0.32-0.02-0.64-0.07-0.94l2.03-1.58c0.18-0.14,0.23-0.41,0.12-0.61 l-1.92-3.32c-0.12-0.22-0.37-0.29-0.59-0.22l-2.39,0.96c-0.5-0.38-1.03-0.7-1.62-0.94L14.4,2.81c-0.04-0.24-0.24-0.41-0.48-0.41 h-3.84c-0.24,0-0.43,0.17-0.47,0.41L9.25,5.35C8.66,5.59,8.12,5.92,7.63,6.29L5.24,5.33c-0.22-0.08-0.47,0-0.59,0.22L2.74,8.87 C2.62,9.08,2.66,9.34,2.86,9.48l2.03,1.58C4.84,11.36,4.8,11.69,4.8,12s0.02,0.64,0.07,0.94l-2.03,1.58 c-0.18,0.14-0.23,0.41-0.12,0.61l1.92,3.32c0.12,0.22,0.37,0.29,0.59,0.22l2.39-0.96c0.5,0.38,1.03,0.7,1.62,0.94l0.36,2.54 c0.05,0.24,0.24,0.41,0.48,0.41h3.84c0.24,0,0.44-0.17,0.47-0.41l0.36-2.54c0.59-0.24,1.13-0.56,1.62-0.94l2.39,0.96 c0.22,0.08,0.47,0,0.59-0.22l1.92-3.32c0.12-0.22,0.07-0.47-0.12-0.61L19.14,12.94z M12,15.6c-1.98,0-3.6-1.62-3.6-3.6 s1.62-3.6,3.6-3.6s3.6,1.62,3.6,3.6S13.98,15.6,12,15.6z" fill="currentColor"/>
            </svg>
          </button>
        </div>
      </div>
      
      <!-- Tabs Navigation -->
      <nav class="tabs-nav">
        <button class="tab-btn active" data-tab="detection">
          <svg width="16" height="16" viewBox="0 0 24 24">
            <path d="M12,1L3,5V11C3,16.55 6.84,21.74 12,23C17.16,21.74 21,16.55 21,11V5L12,1M12,7C13.4,7 14.8,8.6 14.8,10V11.5C15.4,12.1 16,12.8 16,13.8V17.8C16,18.9 15.1,19.8 14,19.8H10C8.9,19.8 8,18.9 8,17.8V13.8C8,12.8 8.6,12.1 9.2,11.5V10C9.2,8.6 10.6,7 12,7Z" fill="currentColor"/>
          </svg>
          Detection
        </button>
        <button class="tab-btn" data-tab="history">
          <svg width="16" height="16" viewBox="0 0 24 24">
            <path d="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M16.2,16.2L11,13V7H12.5V12.2L17,14.9L16.2,16.2Z" fill="currentColor"/>
          </svg>
          History
        </button>
        <button class="tab-btn" data-tab="rules">
          <svg width="16" height="16" viewBox="0 0 24 24">
            <path d="M12,15.5A3.5,3.5 0 0,1 8.5,12A3.5,3.5 0 0,1 12,8.5A3.5,3.5 0 0,1 15.5,12A3.5,3.5 0 0,1 12,15.5M19.43,12.98C19.47,12.66 19.5,12.33 19.5,12C19.5,11.67 19.47,11.34 19.43,11L21.54,9.37C21.73,9.22 21.78,8.95 21.66,8.73L19.66,5.27C19.54,5.05 19.27,4.97 19.05,5.05L16.56,6.05C16.04,5.65 15.48,5.32 14.87,5.07L14.49,2.42C14.46,2.18 14.25,2 14,2H10C9.75,2 9.54,2.18 9.51,2.42L9.13,5.07C8.52,5.32 7.96,5.66 7.44,6.05L4.95,5.05C4.72,4.96 4.46,5.05 4.34,5.27L2.34,8.73C2.21,8.95 2.27,9.22 2.46,9.37L4.57,11C4.53,11.34 4.5,11.67 4.5,12C4.5,12.33 4.53,12.65 4.57,12.97L2.46,14.63C2.27,14.78 2.21,15.05 2.34,15.27L4.34,18.73C4.46,18.95 4.73,19.03 4.95,18.95L7.44,17.94C7.96,18.34 8.52,18.68 9.13,18.93L9.51,21.58C9.54,21.82 9.75,22 10,22H14C14.25,22 14.46,21.82 14.49,21.58L14.87,18.93C15.48,18.67 16.04,18.34 16.56,17.94L19.05,18.95C19.28,19.04 19.54,18.95 19.66,18.73L21.66,15.27C21.78,15.05 21.73,14.78 21.54,14.63L19.43,12.98Z" fill="currentColor"/>
          </svg>
          Rules
        </button>
        <button class="tab-btn" data-tab="advanced">
          <svg width="16" height="16" viewBox="0 0 24 24">
            <path d="M12,2A2,2 0 0,1 14,4C14,4.74 13.6,5.39 13,5.73V7H14A7,7 0 0,1 21,14H22A1,1 0 0,1 23,15V18A1,1 0 0,1 22,19H21V20A2,2 0 0,1 19,22H5A2,2 0 0,1 3,20V19H2A1,1 0 0,1 1,18V15A1,1 0 0,1 2,14H3A7,7 0 0,1 10,7H11V5.73C10.4,5.39 10,4.74 10,4A2,2 0 0,1 12,2M7.5,13A0.5,0.5 0 0,0 7,13.5A0.5,0.5 0 0,0 7.5,14A0.5,0.5 0 0,0 8,13.5A0.5,0.5 0 0,0 7.5,13M16.5,13A0.5,0.5 0 0,0 16,13.5A0.5,0.5 0 0,0 16.5,14A0.5,0.5 0 0,0 17,13.5A0.5,0.5 0 0,0 16.5,13Z" fill="currentColor"/>
          </svg>
          Advanced
        </button>
        <button class="tab-btn" data-tab="sponsor">
          <svg width="16" height="16" viewBox="0 0 24 24">
            <path d="M12,17.27L18.18,21l-1.64-7.03L22,9.24l-7.19-.61L12,2L9.19,8.63L2,9.24l5.46,4.73L5.82,21z" fill="currentColor"/>
          </svg>
          Sponsor
        </button>
      </nav>
    </header>

    <main class="main">
      <!-- Detection Tab -->
      <div id="detectionTab" class="tab-content active">
        <div id="loadingState" class="loading-state">
          <div class="spinner"></div>
          <span>Loading...</span>
        </div>

        <div id="emptyState" class="empty-state" style="display: none;">
          <svg width="48" height="48" viewBox="0 0 24 24" fill="none" opacity="0.5">
            <path d="M12 2L13.09 8.26L22 9L13.09 9.74L12 16L10.91 9.74L2 9L10.91 8.26L12 2Z" stroke="currentColor" stroke-width="2" fill="none"/>
          </svg>
          <h3>No anti-bot solutions detected</h3>
          <p>This page appears to be free of bot protection systems.</p>
        </div>

        <div id="detectionResults" class="detection-results" style="display: none;">
          <div class="results-header">
            <!-- Detection Title Section -->
            <div class="detection-title-section">
              <div class="detection-info">
                <img src="icons/icon32.png" alt="ShieldEye Robot" width="20" height="20" class="section-logo">
                <span id="detectionLabel">ü§ñ Detected Services for the site</span>
                <span id="detectionCount" class="count-badge">0</span>
              </div>
            </div>
            
            <!-- Stats Overview Section -->
            <div id="detectionOverview" class="detection-overview" style="display: none;">
              <div class="stats-grid">
                <div class="stat-card-compact detections-count">
                  <div class="stat-icon-compact">üîç</div>
                  <div class="stat-content-compact">
                    <div class="stat-label-compact">Detections</div>
                    <div class="stat-value-compact" id="detectionsCount">0</div>
                  </div>
                </div>
                
                <div class="stat-card-compact overall-confidence">
                  <div class="stat-icon-compact">üéØ</div>
                  <div class="stat-content-compact">
                    <div class="stat-label-compact">Confidence</div>
                    <div class="stat-value-compact" id="overallConfidence">0%</div>
                  </div>
                </div>
                
                <div class="stat-card-compact difficulty-level">
                  <div class="stat-icon-compact" id="difficultyIcon">üõ°Ô∏è</div>
                  <div class="stat-content-compact">
                    <div class="stat-label-compact">Difficulty</div>
                    <div class="stat-value-compact" id="difficultyLevel">Low</div>
                  </div>
                </div>
                
                <div class="stat-card-compact detection-speed">
                  <div class="stat-icon-compact">‚ö°</div>
                  <div class="stat-content-compact">
                    <div class="stat-label-compact">Speed</div>
                    <div class="stat-value-compact" id="detectionTime">< 1s</div>
                  </div>
                </div>
              </div>
            </div>
            
            <!-- Search and Filter Section -->
            <div class="search-filter-section">
              <div class="search-filter-card">
                <div class="search-and-filter">
                  <div class="search-container">
                    <input type="text" id="detectionSearch" class="search-input" placeholder="Search detections...">
                    <svg class="search-icon" width="14" height="14" viewBox="0 0 24 24">
                      <path d="M15.5 14h-.79l-.28-.27a6.5 6.5 0 1 0-.7.7l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0A4.5 4.5 0 1 1 14 9.5 4.5 4.5 0 0 1 9.5 14z" fill="currentColor"/>
                    </svg>
                  </div>
                  <div class="filter-dropdown">
                    <select id="detectionFilter" class="filter-select">
                      <option value="all">All Categories</option>
                      <option value="Anti-Bot">Anti-Bot</option>
                      <option value="CAPTCHA">CAPTCHA</option>
                      <option value="WAF">WAF</option>
                      <option value="CDN">CDN</option>
                    </select>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div id="resultsList" class="results-list"></div>
          <button id="refreshBtn" class="refresh-btn-bottom" title="Refresh analysis">
            <svg width="16" height="16" viewBox="0 0 24 24">
              <path d="M17.65,6.35C16.2,4.9 14.21,4 12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20C15.73,20 18.84,17.45 19.73,14H17.65C16.83,16.33 14.61,18 12,18A6,6 0 0,1 6,12A6,6 0 0,1 12,6C13.66,6 15.14,6.69 16.22,7.78L13,11H20V4L17.65,6.35Z" fill="currentColor"/>
            </svg>
            Refresh Analysis
          </button>
          <div id="detectionsPagination" class="pagination" style="display: none;">
            <div id="detectionsPaginationInfo" class="pagination-info">Showing 1-10 of 0</div>
            <div class="pagination-controls">
              <button id="detectionsPrevBtn" class="pagination-btn" disabled>
                <svg width="16" height="16" viewBox="0 0 24 24">
                  <path d="M15.41 7.41L14 6L8 12L14 18L15.41 16.59L10.83 12Z" fill="currentColor"/>
                </svg>
              </button>
              <div id="detectionsPageNumbers" class="page-numbers"></div>
              <button id="detectionsNextBtn" class="pagination-btn" disabled>
                <svg width="16" height="16" viewBox="0 0 24 24">
                  <path d="M10 6L8.59 7.41L13.17 12L8.59 16.59L10 18L16 12Z" fill="currentColor"/>
                </svg>
              </button>
            </div>
          </div>
        </div>

        <div id="disabledState" class="disabled-state" style="display: none;">
          <svg width="48" height="48" viewBox="0 0 24 24" fill="none" opacity="0.5">
            <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm3.5 6L12 10.5 8.5 8 12 5.5 15.5 8zm-.5 9.5c0 .83-.67 1.5-1.5 1.5s-1.5-.67-1.5-1.5.67-1.5 1.5-1.5 1.5.67 1.5 1.5zm-6-5c0 .83-.67 1.5-1.5 1.5S6 13.33 6 12.5s.67-1.5 1.5-1.5S9 11.67 9 12.5z" fill="currentColor"/>
          </svg>
          <h3>Detection Disabled</h3>
          <p>Toggle the switch to enable anti-bot detection.</p>
        </div>
      </div>

      <!-- History Tab -->
      <div id="historyTab" class="tab-content" style="display: none;">
        <div class="history-header">
          <div class="header-actions">
            <div class="search-container">
              <input type="text" id="historySearch" class="search-input" placeholder="Search by URL, detector name or category...">
              <svg class="search-icon" width="14" height="14" viewBox="0 0 24 24">
                <path d="M15.5 14h-.79l-.28-.27a6.5 6.5 0 1 0-.7.7l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0A4.5 4.5 0 1 1 14 9.5 4.5 4.5 0 0 1 9.5 14z" fill="currentColor"/>
              </svg>
            </div>
            <button id="exportHistoryBtn" class="export-btn-small" title="Export history">
              <svg width="10" height="10" viewBox="0 0 24 24">
                <path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20M8,11.5H16V10L19.5,12.5L16,15V13.5H8V11.5Z" fill="currentColor"/>
              </svg>
              Export
            </button>
            <button id="clearHistoryBtn" class="clear-btn" title="Clear history">
              <svg width="12" height="12" viewBox="0 0 24 24">
                <path d="M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z" fill="currentColor"/>
              </svg>
              Clear
            </button>
          </div>
        </div>
        <div id="historyList" class="history-list"></div>
        <div id="historyPagination" class="pagination" style="display: none;">
          <div id="historyPaginationInfo" class="pagination-info">Showing 1-10 of 0</div>
          <div class="pagination-controls">
            <button id="historyPrevBtn" class="pagination-btn" disabled>
              <svg width="16" height="16" viewBox="0 0 24 24">
                <path d="M15.41 7.41L14 6L8 12L14 18L15.41 16.59L10.83 12Z" fill="currentColor"/>
              </svg>
            </button>
            <div id="historyPageNumbers" class="page-numbers"></div>
            <button id="historyNextBtn" class="pagination-btn" disabled>
              <svg width="16" height="16" viewBox="0 0 24 24">
                <path d="M10 6L8.59 7.41L13.17 12L8.59 16.59L10 18L16 12Z" fill="currentColor"/>
              </svg>
            </button>
          </div>
        </div>
        <div id="historyEmpty" class="empty-state" style="display: none;">
          <svg width="48" height="48" viewBox="0 0 24 24" fill="none" opacity="0.5">
            <path d="M13,3A9,9 0 0,0 4,12H1L4.89,15.89L4.96,16.03L9,12H6A7,7 0 0,1 13,5A7,7 0 0,1 20,12A7,7 0 0,1 13,19C11.07,19 9.32,18.21 8.06,16.94L6.64,18.36C8.27,20 10.5,21 13,21A9,9 0 0,0 22,12A9,9 0 0,0 13,3Z" stroke="currentColor" stroke-width="2" fill="none"/>
          </svg>
          <h3>No history yet</h3>
          <p>Detection history will appear here as you browse websites.</p>
        </div>
      </div>

      <!-- Custom Rules Tab -->
      <div id="rulesTab" class="tab-content" style="display: none;">
        <div class="rules-header">
          <div class="header-actions">
            <div class="search-container">
              <input type="text" id="rulesSearch" class="search-input" placeholder="Search rules...">
              <svg class="search-icon" width="14" height="14" viewBox="0 0 24 24">
                <path d="M15.5 14h-.79l-.28-.27a6.5 6.5 0 1 0-.7.7l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0A4.5 4.5 0 1 1 14 9.5 4.5 4.5 0 0 1 9.5 14z" fill="currentColor"/>
              </svg>
            </div>
            <button id="importRulesBtn" class="import-btn-small" title="Import">
              <svg width="10" height="10" viewBox="0 0 24 24">
                <path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20M8,15H16V17L12,21L8,17V15Z" fill="currentColor"/>
              </svg>
              Import
            </button>
            <input type="file" id="importRulesFile" accept=".json" style="display: none;">
            <button id="exportRulesBtn" class="export-btn-small" title="Export">
              <svg width="10" height="10" viewBox="0 0 24 24">
                <path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20M8,11.5H16V10L19.5,12.5L16,15V13.5H8V11.5Z" fill="currentColor"/>
              </svg>
              Export
            </button>
            <button id="clearRulesBtn" class="clear-btn-small" title="Clear All Rules">
              <svg width="12" height="12" viewBox="0 0 24 24">
                <path d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z" fill="currentColor"/>
              </svg>
              Clear
            </button>
            <button id="addRuleBtn" class="add-btn" title="Add Rule">
              <svg width="10" height="10" viewBox="0 0 24 24">
                <path d="M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z" fill="currentColor"/>
              </svg>
              Add
            </button>
          </div>
        </div>
        <div id="customRulesList" class="custom-rules-list"></div>
        <div id="rulesPagination" class="pagination" style="display: none;">
          <div id="rulesPaginationInfo" class="pagination-info">Showing 1-10 of 0</div>
          <div class="pagination-controls">
            <button id="rulesPrevBtn" class="pagination-btn" disabled>
              <svg width="16" height="16" viewBox="0 0 24 24">
                <path d="M15.41 7.41L14 6L8 12L14 18L15.41 16.59L10.83 12Z" fill="currentColor"/>
              </svg>
            </button>
            <div id="rulesPageNumbers" class="page-numbers"></div>
            <button id="rulesNextBtn" class="pagination-btn" disabled>
              <svg width="16" height="16" viewBox="0 0 24 24">
                <path d="M10 6L8.59 7.41L13.17 12L8.59 16.59L10 18L16 12Z" fill="currentColor"/>
              </svg>
            </button>
          </div>
        </div>
        <div id="rulesEmpty" class="empty-state" style="display: none;">
          <svg width="48" height="48" viewBox="0 0 24 24" fill="none" opacity="0.5">
            <path d="M19,3H5C3.89,3 3,3.89 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3M19,5V19H5V5H19Z" stroke="currentColor" stroke-width="2" fill="none"/>
          </svg>
          <h3>No custom rules</h3>
          <p>Add custom detection rules to identify specific anti-bot solutions.</p>
        </div>
      </div>

      <!-- Advanced Tab -->
      <div id="advancedTab" class="tab-content" style="display: none;">
        <div class="capture-header">
          <h3>Captcha Parameter Capture</h3>
          <p class="capture-subtitle">Capture captcha parameters for solving services</p>
        </div>

        <!-- Terms of Service Section -->
        <div id="captureTermsSection" class="capture-terms-section">
          <div class="terms-container">
            <div class="terms-icon">
              <svg width="48" height="48" viewBox="0 0 24 24">
                <path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm0 10.99h7c-.53 4.12-3.28 7.79-7 8.94V12H5V6.3l7-3.11v8.8z" fill="#3b82f6"/>
              </svg>
            </div>
            <h4>Important Information</h4>
            <div class="terms-content">
              <p><strong>Please read carefully before proceeding:</strong></p>
              <div class="terms-box">
                <h5>üéØ How to Capture Parameters</h5>
                <p>After clicking "Start Capturing", the popup will automatically close. You must then trigger the captcha on the page:</p>
                <ul>
                  <li><strong>Page Load Captcha:</strong> Refresh the page (F5)</li>
                  <li><strong>Form Submit Captcha:</strong> Submit the form that contains the captcha</li>
                  <li><strong>Button Click Captcha:</strong> Click the button that triggers the captcha</li>
                  <li><strong>Invisible Captcha:</strong> Perform the action that normally triggers it</li>
                </ul>
                
                <h5>‚ö†Ô∏è Important Notes</h5>
                <ul>
                  <li>The capture will start immediately after clicking the button</li>
                  <li>Parameters will be captured when the captcha loads or validates</li>
                  <li>You can view captured data by reopening the extension</li>
                  <li>Clear captured data before starting a new capture session</li>
                </ul>
                
                <h5>üìã Supported Captcha Types</h5>
                <p>This tool can capture parameters from: reCAPTCHA (v2/v3/Enterprise), others soon!.</p>
              </div>
              <div class="terms-checkbox">
                <input type="checkbox" id="acceptTermsCheckbox">
                <label for="acceptTermsCheckbox">I understand how to use the capture feature</label>
              </div>
              <button id="acceptTermsBtn" class="accept-terms-btn" disabled>
                Continue to Capture Setup
              </button>
            </div>
          </div>
        </div>

        <!-- Capture Selection Section (Initially Hidden) -->
        <div id="captureSelectionSection" class="capture-selection" style="display: none;">
          <div class="help-link-container">
            <button id="howItWorksBtn" class="how-it-works-link">
              <svg width="16" height="16" viewBox="0 0 24 24">
                <path d="M11 18h2v-2h-2v2zm1-16C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm0-14c-2.21 0-4 1.79-4 4h2c0-1.1.9-2 2-2s2 .9 2 2c0 2-3 1.75-3 5h2c0-2.25 3-2.5 3-5 0-2.21-1.79-4-4-4z" fill="currentColor"/>
              </svg>
              How this works?
            </button>
          </div>
          <div class="detection-selector">
            <h4>Available Detections</h4>
            <div id="detectionCheckboxList" class="detection-checkbox-list">
              <!-- Checkboxes will be populated here -->
            </div>
            <div id="noDetectionsMessage" class="no-detections-message" style="display: none;">
              <svg width="32" height="32" viewBox="0 0 24 24" fill="none" opacity="0.5">
                <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z" fill="currentColor"/>
              </svg>
              <p>No captchas detected on this page</p>
            </div>
          </div>
          
          <div class="capture-controls">
            <button id="startCaptureBtn" class="capture-btn start-capture" disabled>
              <svg width="16" height="16" viewBox="0 0 24 24">
                <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z" fill="currentColor"/>
              </svg>
              Start Capturing
            </button>
            <button id="stopCaptureBtn" class="capture-btn stop-capture" style="display: none;">
              <svg width="16" height="16" viewBox="0 0 24 24">
                <path d="M6 6h12v12H6z" fill="currentColor"/>
              </svg>
              Stop Capturing
            </button>
            <button id="clearCapturesBtn" class="capture-btn clear-captures">
              <svg width="16" height="16" viewBox="0 0 24 24">
                <path d="M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z" fill="currentColor"/>
              </svg>
              Clear All
            </button>
          </div>
        </div>

        <div id="captureInstructions" class="capture-instructions" style="display: none;">
          <div class="instructions-content">
            <svg width="24" height="24" viewBox="0 0 24 24">
              <path d="M13,9H11V7H13M13,17H11V11H13M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z" fill="#f59e0b"/>
            </svg>
            <div>
              <h4>Capture Mode Active</h4>
              <p>Now trigger the captcha to capture its parameters:</p>
              <ul>
                <li>If captcha appears on page load ‚Üí Refresh the page</li>
                <li>If captcha appears on form submit ‚Üí Submit the form</li>
                <li>If captcha appears on button click ‚Üí Click the button</li>
              </ul>
            </div>
          </div>
        </div>

        <div id="capturedParameters" class="captured-parameters" style="display: none;">
          <div class="captured-header">
            <h4>Captured Parameters</h4>
            <span id="captureCount" class="capture-count">0 captures</span>
          </div>
          <div class="capture-table-container">
            <table id="captureTable" class="capture-table">
              <thead>
                <tr>
                  <th>Site URL</th>
                  <th>Site Key</th>
                  <th>Action/Type</th>
                  <th>V2</th>
                  <th>V2 Invisible</th>
                  <th>V3</th>
                  <th>Enterprise</th>
                  <th>S</th>
                  <th>API Domain</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody id="captureTableBody">
                <!-- Captured parameters will be shown here -->
              </tbody>
            </table>
          </div>
        </div>

        <div id="advancedEmpty" class="empty-state advanced-disabled" style="display: none !important;">
          <div class="advanced-coming-soon-container">
            <div class="advanced-coming-soon-content">
              <div class="coming-soon-icon-advanced">
                <svg width="40" height="40" viewBox="0 0 24 24" style="opacity: 0.3;">
                  <path d="M12,1L3,5V11C3,16.55 6.84,21.74 12,23C17.16,21.74 21,16.55 21,11V5L12,1M12,7C13.4,7 14.8,8.6 14.8,10V11.5C15.4,12.1 16,12.8 16,13.8V17.8C16,18.9 15.1,19.8 14,19.8H10C8.9,19.8 8,18.9 8,17.8V13.8C8,12.8 8.6,12.1 9.2,11.5V10C9.2,8.6 10.6,7 12,7Z" fill="currentColor"/>
                </svg>
              </div>
              
              <h2 class="advanced-coming-soon-title">No reCAPTCHA Detected</h2>
              <p class="advanced-coming-soon-description">
                Parameter capture is only available on websites that use supported CAPTCHA services.
              </p>
              
              <div class="advanced-coming-soon-features">
                <h4>To use parameter capture:</h4>
                <div class="advanced-feature-list">
                  <div class="feature-item">
                    <span style="color: var(--accent); margin-right: 8px;">‚Üí</span>
                    Visit a website with reCAPTCHA v2, v3, or Enterprise
                  </div>
                  <div class="feature-item">
                    <span style="color: var(--accent); margin-right: 8px;">‚Üí</span>
                    Return to this Advanced tab to see capture options
                  </div>
                  <div class="feature-item">
                    <span style="color: var(--accent); margin-right: 8px;">‚Üí</span>
                    Click "Start Capturing" when ready
                  </div>
                  <div class="feature-item">
                    <span style="color: var(--accent); margin-right: 8px;">‚Üí</span>
                    Trigger the CAPTCHA to capture parameters
                  </div>
                </div>
              </div>
              
              <div class="test-sites-suggestion">
                <h4>üß™ Try these test sites:</h4>
                <div class="test-links">
                  <span class="test-link">recaptcha-demo.appspot.com</span>
                  <span class="test-link">google.com/recaptcha</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Sponsor Tab -->
      <div id="sponsorTab" class="tab-content">
        <div class="empty-state" style="padding: 60px 20px; text-align: center;">
          <svg width="60" height="60" viewBox="0 0 24 24" style="opacity: 0.3; margin-bottom: 20px;">
            <path d="M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2M11,16.5L18,9.5L16.59,8.09L11,13.67L7.91,10.59L6.5,12L11,16.5Z" fill="currentColor"/>
          </svg>
          <h2 style="font-size: 24px; font-weight: 600; margin-bottom: 10px; color: var(--text-primary);">Coming Soon</h2>
          <p style="color: var(--text-secondary); font-size: 14px;">Sponsorship opportunities will be available soon</p>
        </div>
      </div>
    </main>
  </div>

  <!-- Instructions Modal -->
  <div id="instructionsModal" class="modal" style="display: none;">
    <div class="modal-content instructions-modal">
      <div class="modal-header">
        <h3>How to Capture Parameters</h3>
        <button class="modal-close" data-modal="instructionsModal" title="Close">
          <svg width="20" height="20" viewBox="0 0 24 24">
            <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z" fill="currentColor"/>
          </svg>
        </button>
      </div>
      <div class="modal-body instructions-body">
        <div class="instructions-content">
          <h4>üéØ Steps to Capture</h4>
          <div class="instruction-lines-simple">
            <div class="instruction-line">After clicking "Start Capturing", the popup will automatically close</div>
            <div class="instruction-line">You must then trigger the captcha on the page:</div>
            <div class="instruction-spacer"></div>
            
            <div class="instruction-line"><span class="instruction-bullet">‚Ä¢</span> Page Load Captcha</div>
            <div class="instruction-line instruction-indent">‚Üí Refresh the page (F5)</div>
            <div class="instruction-spacer"></div>
            
            <div class="instruction-line"><span class="instruction-bullet">‚Ä¢</span> Form Submit Captcha</div>
            <div class="instruction-line instruction-indent">‚Üí Submit the form that contains the captcha</div>
            <div class="instruction-spacer"></div>
            
            <div class="instruction-line"><span class="instruction-bullet">‚Ä¢</span> Button Click Captcha</div>
            <div class="instruction-line instruction-indent">‚Üí Click the button that triggers the captcha</div>
            <div class="instruction-spacer"></div>
            
            <div class="instruction-line"><span class="instruction-bullet">‚Ä¢</span> Invisible Captcha</div>
            <div class="instruction-line instruction-indent">‚Üí Perform the action that normally triggers it</div>
          </div>
          
          <h4>‚ö†Ô∏è Important Notes</h4>
          <div class="instruction-lines-simple">
            <div class="instruction-line">‚Ä¢ The capture will start immediately after clicking the button</div>
            <div class="instruction-line">‚Ä¢ Parameters will be captured when the captcha loads or validates</div>
            <div class="instruction-line">‚Ä¢ You can view captured data by reopening the extension</div>
            <div class="instruction-line">‚Ä¢ Clear captured data before starting a new capture session</div>
          </div>
          
          <h4>üìã Supported Captcha Types</h4>
          <div class="instruction-lines-simple">
            <div class="instruction-line">This tool can capture parameters from:</div>
            <div class="instruction-spacer"></div>
            <div class="instruction-line">‚Ä¢ reCAPTCHA (v2/v3/Enterprise)</div>
            <div class="instruction-line">‚Ä¢ And more soon!</div>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="modal-action-btn close-instructions-btn">Got it!</button>
      </div>
    </div>
  </div>

  <!-- Export Modal -->
  <div id="exportModal" class="modal" style="display: none;">
    <div class="modal-content export-modal">
      <div class="modal-header">
        <h3>Export Detection Data</h3>
        <button id="closeExportModal" class="close-btn">&times;</button>
      </div>
      <div class="modal-body">
        <div class="export-step" id="providerStep">
          <h4>1. Choose Provider</h4>
          <div class="provider-grid" id="providerGrid">
            <!-- Providers will be loaded here -->
          </div>
        </div>
        
        <div class="export-step" id="configStep" style="display: none;">
          <h4>2. Configure Settings</h4>
          <div class="provider-info">
            <div class="provider-header">
              <span id="selectedProviderName"></span>
              <button id="backToProviders" class="back-btn">‚Üê Back</button>
            </div>
            <div id="providerDescription"></div>
          </div>
          <form id="providerConfig" class="provider-config">
            <!-- Configuration fields will be loaded here -->
          </form>
        </div>
        
        <div class="export-step" id="outputStep" style="display: none;">
          <h4>3. Export Data</h4>
          <div class="task-type-selection">
            <label for="taskTypeSelect">Task Type:</label>
            <select id="taskTypeSelect" class="select-field">
              <!-- Task types will be loaded here -->
            </select>
          </div>
          <div id="exportOutput" class="export-output"></div>
        </div>
      </div>
      <div class="modal-footer">
        <button id="generateExport" class="primary-btn" style="display: none;">Generate Export</button>
        <button id="copyBtn" class="copy-btn" style="display: none;">Copy to Clipboard</button>
        <button id="downloadBtn" class="download-btn" style="display: none;">Download</button>
      </div>
    </div>
  </div>

  <!-- Settings Modal -->
  <div id="settingsModal" class="modal" style="display: none;">
    <div class="modal-content clean-settings-modal">
      <div class="clean-modal-header">
        <div class="header-content">
          <div class="header-icon">
            <svg width="24" height="24" viewBox="0 0 24 24">
              <path d="M19.14,12.94c0.04-0.3,0.06-0.61,0.06-0.94c0-0.32-0.02-0.64-0.07-0.94l2.03-1.58c0.18-0.14,0.23-0.41,0.12-0.61 l-1.92-3.32c-0.12-0.22-0.37-0.29-0.59-0.22l-2.39,0.96c-0.5-0.38-1.03-0.7-1.62-0.94L14.4,2.81c-0.04-0.24-0.24-0.41-0.48-0.41 h-3.84c-0.24,0-0.43,0.17-0.47,0.41L9.25,5.35C8.66,5.59,8.12,5.92,7.63,6.29L5.24,5.33c-0.22-0.08-0.47,0-0.59,0.22L2.74,8.87 C2.62,9.08,2.66,9.34,2.86,9.48l2.03,1.58C4.84,11.36,4.8,11.69,4.8,12s0.02,0.64,0.07,0.94l-2.03,1.58 c-0.18,0.14-0.23,0.41-0.12,0.61l1.92,3.32c0.12,0.22,0.37,0.29,0.59,0.22l2.39-0.96c0.5,0.38,1.03,0.7,1.62,0.94l0.36,2.54 c0.05,0.24,0.24,0.41,0.48,0.41h3.84c0.24,0,0.44-0.17,0.47-0.41l0.36-2.54c0.59-0.24,1.13-0.56,1.62-0.94l2.39,0.96 c0.22,0.08,0.47,0,0.59-0.22l1.92-3.32c0.12-0.22,0.07-0.47-0.12-0.61L19.14,12.94z M12,15.6c-1.98,0-3.6-1.62-3.6-3.6 s1.62-3.6,3.6-3.6s3.6,1.62,3.6,3.6S13.98,15.6,12,15.6z" fill="currentColor"/>
            </svg>
          </div>
          <div class="header-text">
            <h2>Settings</h2>
            <p>Extension configuration</p>
          </div>
        </div>
        <button id="closeSettingsModal" class="clean-close-btn">
          <svg width="18" height="18" viewBox="0 0 24 24">
            <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z" fill="currentColor"/>
          </svg>
        </button>
      </div>
      
      <div class="clean-modal-body">
        <!-- Excluded Domains Section -->
        <div class="clean-settings-section">
          <div class="section-title">
            <div class="section-icon-small">
              <svg width="18" height="18" viewBox="0 0 24 24">
                <path d="M12,1L3,5V11C3,16.55 6.84,21.74 12,23C17.16,21.74 21,16.55 21,11V5L12,1M12,7C13.4,7 14.8,8.6 14.8,10V11.5C15.4,12.1 16,12.8 16,13.8V17.8C16,18.9 15.1,19.8 14,19.8H10C8.9,19.8 8,18.9 8,17.8V13.8C8,12.8 8.6,12.1 9.2,11.5V10C9.2,8.6 10.6,7 12,7Z" fill="currentColor"/>
              </svg>
            </div>
            <div class="section-text">
              <h3>Excluded Domains</h3>
              <p>Disable ShieldEye detection on specific websites</p>
            </div>
          </div>
          
          <div class="domain-exclusion-controls">
            <div class="domain-input-row">
              <input type="text" id="blacklistInput" class="clean-domain-input" placeholder="example.com">
              <button id="addBlacklistBtn" class="clean-add-btn">
                <svg width="12" height="12" viewBox="0 0 24 24">
                  <path d="M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z" fill="currentColor"/>
                </svg>
                Add
              </button>
              <button id="addCurrentPageBtn" class="clean-add-btn" title="Add current page to blacklist">
                <svg width="12" height="12" viewBox="0 0 24 24">
                  <path d="M14,17H17L19,13V7H13V13H16M6,17H9L11,13V7H5V13H8L6,17Z" fill="currentColor"/>
                </svg>
                Page
              </button>
            </div>
            <div id="blacklistItems" class="clean-domain-list"></div>
            <div id="blacklistPagination" class="blacklist-pagination"></div>
          </div>
        </div>
        
        <!-- System Info -->
        <div class="system-info-footer">
          <div class="info-cards-minimal">
            <div class="info-card-minimal">
              <div class="info-label-minimal">Version</div>
              <div class="info-value-minimal">v0.1.0</div>
            </div>
            <div class="info-card-minimal">
              <div class="info-label-minimal">Build</div>
              <div class="info-value-minimal">Alpha</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Add Custom Rule Modal -->
  <div id="addRuleModal" class="modal" style="display: none;">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Add Custom Detection Rule</h3>
        <button id="closeRuleModal" class="close-btn">&times;</button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label for="ruleName">Solution Name:</label>
          <input type="text" id="ruleName" class="input-field" placeholder="e.g., Custom Anti-Bot">
        </div>
        
        <div class="form-group">
          <label for="ruleCategory">Category:</label>
          <select id="ruleCategory" class="select-field">
            <option value="Anti-Bot">Anti-Bot</option>
            <option value="CAPTCHA">CAPTCHA</option>
            <option value="Fingerprinting">Fingerprinting</option>
            <option value="WAF">WAF</option>
            <option value="CDN">CDN</option>
            <option value="Custom">Custom</option>
          </select>
        </div>
        
        <div class="form-group">
          <label for="ruleIcon">Icon:</label>
          <div class="icon-selector-container">
            <select id="ruleIcon" class="select-field icon-select">
              <option value="custom.png">Custom (Default)</option>
              <option value="akamai.png">Akamai</option>
              <option value="aws.png">AWS WAF</option>
              <option value="cloudflare.png">Cloudflare</option>
              <option value="datadome.png">DataDome</option>
              <option value="f5.png">F5 Networks</option>
              <option value="funcaptcha.png">FunCaptcha (Arkose)</option>
              <option value="geetest.png">GeeTest</option>
              <option value="hcaptcha.png">hCaptcha</option>
              <option value="imperva.png">Imperva/Incapsula</option>
              <option value="perimeterx.png">PerimeterX</option>
              <option value="reblaze.png">Reblaze</option>
              <option value="recaptcha.png">reCAPTCHA</option>
              <option value="sucuri.png">Sucuri</option>
              <option value="upload">üì§ Upload Custom Logo</option>
            </select>
            <img id="iconPreview" class="icon-preview" alt="Icon preview">
            <input type="file" id="customIconUpload" accept="image/*" style="display: none;">
            <button id="uploadIconBtn" class="upload-icon-btn" style="display: none;">Choose File</button>
          </div>
        </div>
        
        <div class="form-group">
          <label for="ruleColor">Badge Color:</label>
          <div style="display: flex; align-items: center; gap: 10px;">
            <input type="color" id="ruleColor" value="#6B7280" style="width: 50px; height: 35px; border: 1px solid var(--border); border-radius: 4px; cursor: pointer;">
            <span id="colorPreview" style="padding: 4px 8px; border-radius: 4px; background: #6B7280; color: white; font-size: 12px;">Preview</span>
          </div>
        </div>
        
        <div class="form-group">
          <label>Detection Methods:</label>
          <div class="detection-methods">
            <div class="method-section">
              <h4>Cookies</h4>
              <div class="rule-headers">
                <span class="rule-header-name">Name</span>
                <span class="rule-header-value">Value (Optional)</span>
                <span class="rule-header-confidence">Confidence</span>
                <span class="rule-header-actions">Actions</span>
              </div>
              <div id="cookieRules" class="rules-list">
                <!-- Cookie rules will be populated by JS -->
              </div>
              <button type="button" id="addCookieRule" class="add-rule-btn">+ Add Cookie Rule</button>
            </div>
            
            <div class="method-section">
              <h4>Headers</h4>
              <div class="rule-headers">
                <span class="rule-header-name">Name</span>
                <span class="rule-header-value">Value (Optional)</span>
                <span class="rule-header-confidence">Confidence</span>
                <span class="rule-header-actions">Actions</span>
              </div>
              <div id="headerRules" class="rules-list">
                <!-- Header rules will be populated by JS -->
              </div>
              <button type="button" id="addHeaderRule" class="add-rule-btn">+ Add Header Rule</button>
            </div>
            
            <div class="method-section">
              <h4>URL Patterns</h4>
              <div class="rule-headers url-headers">
                <span class="rule-header-pattern">Pattern</span>
                <span class="rule-header-confidence">Confidence</span>
                <span class="rule-header-actions">Actions</span>
              </div>
              <div id="urlRules" class="rules-list">
                <!-- URL rules will be populated by JS -->
              </div>
              <button type="button" id="addUrlRule" class="add-rule-btn">+ Add URL Rule</button>
            </div>
            
            <div class="method-section">
              <h4>Script Content</h4>
              <div class="rule-headers script-headers">
                <span class="rule-header-content">Content to Detect</span>
                <span class="rule-header-confidence">Confidence</span>
                <span class="rule-header-actions">Actions</span>
              </div>
              <div id="scriptRules" class="rules-list">
                <!-- Script rules will be populated by JS -->
              </div>
              <button type="button" id="addScriptRule" class="add-rule-btn">+ Add Script Content</button>
            </div>

            <div class="method-section">
              <h4>DOM Elements</h4>
              <div class="rule-headers dom-headers">
                <span class="rule-header-content">CSS Selector</span>
                <span class="rule-header-confidence">Confidence</span>
                <span class="rule-header-actions">Actions</span>
              </div>
              <div id="domRules" class="rules-list">
                <!-- DOM rules will be populated by JS -->
              </div>
              <button type="button" id="addDomRule" class="add-rule-btn">+ Add DOM Selector</button>
            </div>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button id="cancelRuleBtn" class="cancel-btn">Cancel</button>
        <button id="saveRuleBtn" class="save-btn">Save Rule</button>
      </div>
    </div>
  </div>

  <!-- API Customization Modal -->
  <div id="apiCustomizationModal" class="modal" style="display: none;">
    <div class="modal-content api-custom-modal">
      <div class="modal-header">
        <h3>Customize API Payload</h3>
        <button id="closeApiCustomModal" class="close-btn">&times;</button>
      </div>
      <div class="modal-body">
        <div class="api-template-section">
          <div class="template-header">
            <h4>JSON Template</h4>
            <div class="template-actions">
              <button id="resetTemplate" class="reset-btn">Reset to Default</button>
              <button id="previewPayload" class="preview-btn">Preview</button>
            </div>
          </div>
          
          <div class="template-editor">
            <textarea id="apiTemplate" class="template-textarea" placeholder="Enter your custom JSON template here..."></textarea>
          </div>
          
          <div class="variables-help">
            <h5>Available Variables:</h5>
            <div class="variables-grid">
              <div class="variable-item">
                <code>&lt;WEBSITE_URL&gt;</code>
                <span>Current page URL</span>
              </div>
              <div class="variable-item">
                <code>&lt;DOMAIN&gt;</code>
                <span>Website domain</span>
              </div>
              <div class="variable-item">
                <code>&lt;DETECTIONS&gt;</code>
                <span>Array of detected solutions</span>
              </div>
              <div class="variable-item">
                <code>&lt;DETECTION_COUNT&gt;</code>
                <span>Number of detections</span>
              </div>
              <div class="variable-item">
                <code>&lt;TIMESTAMP&gt;</code>
                <span>Current timestamp</span>
              </div>
              <div class="variable-item">
                <code>&lt;USER_AGENT&gt;</code>
                <span>Browser user agent</span>
              </div>
            </div>
          </div>
          
          <div id="templatePreview" class="template-preview" style="display: none;">
            <h5>Preview Output:</h5>
            <pre id="previewContent"></pre>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button id="cancelApiCustom" class="cancel-btn">Cancel</button>
        <button id="saveApiTemplate" class="save-btn">Save Template</button>
      </div>
    </div>
  </div>

  <!-- Confirmation Modal -->
  <div id="confirmModal" class="modal" style="display: none;">
    <div class="modal-content compact">
      <div class="modal-header">
        <h3 id="confirmTitle">Confirm Action</h3>
      </div>
      <div class="modal-body">
        <p id="confirmMessage">Are you sure you want to proceed?</p>
      </div>
      <div class="modal-footer">
        <button id="confirmCancel" class="btn-secondary">Cancel</button>
        <button id="confirmOk" class="btn-primary">Confirm</button>
      </div>
    </div>
  </div>

  <script src="scripts/pbf.js"></script>
  <script src="scripts/message.browser.js"></script>
  <script src="popup.js"></script>
</body>
</html>